jQuery(function(t){var e=function(){var e=("https:"==location.protocol?"https:":"http:")+"//formoid.net/api/push",n=function(){var e=(/MSIE (\d+)\./.exec(navigator.userAgent)||[0,0])[1]
return 8==e||9==e&&"file:"!=location.protocol?function(e,n){var a=new XDomainRequest,r=t.Deferred()
return a.open(n.type,e),a.onload=function(){r.resolve(this.responseText)},a.onerror=function(){r.reject()},a.send(n.data),r}:(t.support.cors=!0,t.ajax)}(),a=function(t,e){return t="__"+t+"__",e.length?(this[t]=e[0],this):this[t]},r=function(e,n,a){return t.each(a,function(t,a){e[a]=function(){return n[a].apply(n,arguments)}}),e},i=function(t){t=t||{},this.__email__=t.email||"",this.__title__=t.title||"",this.__data__=t.data||[]}
return i.prototype.email=function(t){return a.call(this,"email",arguments)},i.prototype.title=function(t){return a.call(this,"title",arguments)},i.prototype.data=function(t){return a.call(this,"data",arguments)},i.prototype.send=function(a,i){var o=r(t.Deferred(),this,["email","title","data","send"])
return i&&(i.call(this,o),"pending"!=o.state())?o:(n(e,{type:"POST",data:JSON.stringify({email:this.__email__,form:{title:this.__title__,data:arguments.length?a:this.__data__}})}).done(function(t){try{var e=JSON.parse(t)
e.error?o.reject(e.error):o.resolve(e.response)}catch(n){o.reject("Incorrect server response.")}}).fail(function(){var t="Failed to query the server. "
t+="onLine"in navigator&&!navigator.onLine?"No connection to the Internet.":"Check the connection and try again.",o.reject(t)}),o)},{Form:function(t){return new i(t)}}}()
t('[data-form-type="formoid"]').each(function(){var n,a=t(this),r=a.is("form")?a:a.find("form"),i=a.find("[data-form-alert]"),o=a.is("[data-form-title]")?a:a.find("[data-form-title]"),s=a.find('[type="submit"]')
s.html('<span class="btn-text">'+s.html()+'</span><i class="btn-loader"></i>').click(function(){r.addClass("form-active")}),r.submit(function(l){if(l.preventDefault(),r.addClass("form-active"),!s.hasClass("btn-loading")){var c=[]
n=n||e.Form({email:a.find("[data-form-email]").val(),title:o.attr("data-form-title")||o.text()}),i.html(""),s.addClass("btn-loading"),a.find("[data-form-field]").each(function(){c.push([t(this).attr("data-form-field")||t(this).attr("name"),t(this).val()])}),n.send(c).done(function(e){r.removeClass("form-active"),a.find("[data-form-field]").val(""),i.append(t('<div class="alert alert-success text-center"/>').text(e))}).fail(function(e){i.append(t('<div class="alert alert-danger text-center"/>').text(e))}).always(function(){s.removeClass("btn-loading")})}})})})
